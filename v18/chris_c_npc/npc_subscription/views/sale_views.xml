<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <record id="sale_subscription_order_view_form" model="ir.ui.view">
        <field name="name">sale.subscription.order.form.inherited.npc_subscription</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_subscription.sale_subscription_order_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[@name='subscription_info']" position="replace">
                <group name="subscription_info" string="Subscription" invisible="not is_subscription and subscription_state != '7_upsell'">
                    <field name="start_date" groups="!sales_team.group_sale_manager" readonly="subscription_state in ['2_renewal', '3_progress', '4_paused']"/>
                    <field name="start_date" groups="sales_team.group_sale_manager" readonly="subscription_state == '2_renewal'"/>
                    <field name="first_contract_date" invisible="not origin_order_id"/>
                    <field name="origin_order_id" readonly="1" invisible="not origin_order_id"/>
                    <field name="subscription_id" readonly="1"/>
                    <field name="payment_token_id" options="{'no_create': True}"/>
                    <field name="payment_exception"/>
                    <field name="pending_transaction"/>
                </group>
            </xpath>
            <xpath expr="//div[@name='plan_block']" position="after">
                <field name="start_date"
                       groups="!sales_team.group_sale_manager"
                       readonly="subscription_state in ['2_renewal', '3_progress', '4_paused']"
                       invisible="not is_subscription and subscription_state != '7_upsell'"/>
                <field name="start_date"
                       groups="sales_team.group_sale_manager"
                       readonly="subscription_state == '2_renewal'"
                       invisible="not is_subscription and subscription_state != '7_upsell'"/>
            </xpath>
            <xpath expr="//button[@name='action_quotation_send']" position="attributes">
                <attribute name="invisible">state != 'draft' or is_subscription</attribute>
            </xpath>
        </field>
    </record>
    <record id="sale_subscription_view_tree" model="ir.ui.view">
        <field name="name">sale.subscription.order.list.inherited.npc_subscription</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_subscription.sale_subscription_view_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//list" position="attributes">
                <attribute name="default_order">create_date desc, next_invoice_date asc, end_date asc</attribute>
            </xpath>
        </field>
    </record>

</odoo>